---
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .filter(({ data }) => data.pubDate.valueOf() <= new Date().valueOf())
  .slice(0, 2);

const formatter = new Intl.DateTimeFormat("pl-PL", {
  day: "2-digit",
  month: "long",
  year: "numeric",
});
---

<section class="service-card blog-section" id="blog">
  <h2>Poradnik ‚Äì Artyku≈Çy o udra≈ºnianiu kanalizacji</h2>
  <p class="lead">
    Zobacz praktyczne porady, jak dbaƒá o kanalizacjƒô, zapobiegaƒá zatorom oraz
    kiedy lepiej od razu wezwaƒá hydraulika.
  </p>

  <div class="blog-grid">
    {
      posts.map((article) => (
        <article
          class="blog-card"
          itemscope
          itemtype="https://schema.org/BlogPosting"
        >
          <meta
            itemprop="datePublished"
            content={article.data.pubDate.toISOString( )}
          />
          <meta itemprop="author" content="Hydraulik Warszawa" />

          <div class="blog-card-image">
            <img
              src={article.data.hero.src}
              alt={article.data.title}
              width="400"
              height="250"
              loading="lazy"
              itemprop="image"
            />
          </div>

          <div class="blog-card-content">
            <span class="blog-category">{article.data.category}</span>

            <h3 itemprop="headline">
              <a href={`/blog/${article.slug}`} itemprop="url">
                {article.data.title}
              </a>
            </h3>

            <p itemprop="description">{article.data.description}</p>

            <div class="blog-meta">
              <span
                class="blog-author"
                itemprop="author"
                itemscope
                itemtype="https://schema.org/Person"
              >
                <span itemprop="name">Hydraulik Warszawa</span>
              </span>

              <span class="blog-date">
                <span class="meta-icon">üìÖ</span>
                <span>{formatter.format(article.data.pubDate )}</span>
              </span>

              <span class="blog-read-time">
                <span class="meta-icon">‚è±</span>
                <span>{article.data.readingTime}</span>
              </span>
            </div>

            <a href={`/blog/${article.slug}`} class="btn btn--outline">
              Czytaj wiƒôcej
            </a>
          </div>
        </article>
      ))
    }

     {/* KARTA KU PRZESTRODZE - WYR√ì≈ªNIONA */}
    <article class="blog-card warning-card">
      <div class="blog-card-image warning-image">
        <div class="warning-tag">‚ö†Ô∏è KU PRZESTRODZE</div>
        <img
          src="/img/skutki-udrazniania-kanalizaji-chemia-hero.webp" 
          alt="Zniszczone rury przez chemiƒô"
          width="733"
          height="317"
          loading="lazy"
        />
      </div>
      <div class="blog-card-content">
        <span class="blog-category category-warning">EFEKTY CHEMII</span>
        <h3>
          <a href="/ku-przestrodze">Jak chemia niszczy rury? Galeria zniszcze≈Ñ</a>
        </h3>
        <p>Zobacz autentyczne zdjƒôcia z naszych interwencji. Skamienia≈Çe granulki, stopione syfony i zniszczone zlewy.</p>
        <a href="/ku-przestrodze" class="btn btn--warning">Zobacz galeriƒô przypadk√≥w</a>
      </div>
    </article>
  </div>
</section>

<style>
  .warning-card {
    border: 1px solid #e7736685 !important;
    background-color: #fff5f5 !important;
  }
  .category-warning {
    background-color: #e74c3c !important;
    color: white !important;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: bold;
  }
  .warning-image {
    position: relative;
  }
  .warning-tag {
    position: absolute;
    top: 10px;
    left: 10px;
    background: #e74c3c;
    color: white;
    padding: 5px 10px;
    font-weight: bold;
    z-index: 10;
    border-radius: 4px;
    font-size: 14px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .btn--warning {
    background-color: #e74c3c !important;
    color: white !important;
    border: none !important;
    padding: 10px 20px;
    border-radius: 4px;
    text-decoration: none;
    display: inline-block;
    margin-top: 10px;
    font-weight: bold;
    text-align: center;
  }
  .btn--warning:hover {
    background-color: #c0392b !important;
  }
</style>




<!--
---
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .filter(({ data }) => data.pubDate.valueOf() <= new Date().valueOf())
  .slice(0, 2);

const formatter = new Intl.DateTimeFormat("pl-PL", {
  day: "2-digit",
  month: "long",
  year: "numeric",
});
---

<section class="service-card blog-section" id="blog">
  <h2>Poradnik ‚Äì Artyku≈Çy o udra≈ºnianiu kanalizacji</h2>
  <p class="lead">
    Zobacz praktyczne porady, jak dbaƒá o kanalizacjƒô, zapobiegaƒá zatorom oraz
    kiedy lepiej od razu wezwaƒá hydraulika.
  </p>

  <div class="blog-grid">
    {
      posts.map((article) => (
        <article
          class="blog-card"
          itemscope
          itemtype="https://schema.org/BlogPosting"
        >
          <meta
            itemprop="datePublished"
            content={article.data.pubDate.toISOString()}
          />
          <meta itemprop="author" content="Hydraulik Warszawa" />

          <div class="blog-card-image">
            <img
              src={article.data.hero.src}
              alt={article.data.title}
              width="400"
              height="250"
              loading="lazy"
              itemprop="image"
            />
          </div>

          <div class="blog-card-content">
            <span class="blog-category">{article.data.category}</span>

            <h3 itemprop="headline">
              <a href={`/blog/${article.slug}`} itemprop="url">
                {article.data.title}
              </a>
            </h3>

            <p itemprop="description">{article.data.description}</p>

            <div class="blog-meta">
              <span
                class="blog-author"
                itemprop="author"
                itemscope
                itemtype="https://schema.org/Person"
              >
                <span itemprop="name">Hydraulik Warszawa</span>
              </span>

              <span class="blog-date">
                <span class="meta-icon">üìÖ</span>
                <span>{formatter.format(article.data.pubDate)}</span>
              </span>

              <span class="blog-read-time">
                <span class="meta-icon">‚è±</span>
                <span>{article.data.readingTime}</span>
              </span>
            </div>

            <a href={`/blog/${article.slug}`} class="btn btn--outline">
              Czytaj wiƒôcej
            </a>
          </div>
        </article>
      ))
    }
  </div>
</section>

-->